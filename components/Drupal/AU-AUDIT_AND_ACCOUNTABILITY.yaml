name: Drupal
family: AUDIT AND ACCOUNTABILITY
documentation_complete: false
schema_version: 3.0.0
satisfies:

- control_key: AU-02
  control_key_part: a
  control_name: AUDITABLE EVENTS
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    Transaction logs are generated by the Apache web server, Drupal CMS, MySQL database
    and PHP page processing.  Specifically, the following server, application, database
    and network device audit log events are captured:

    • Apache access log :: Contains a list of requests for your website that have
    bypassed Varnish. These requests include pages, theme files, and static media files.

    • Apache error log :: Records any Apache-level issues. The issues reported here are
    usually caused by general server issues, including capacity problems, .htaccess problems,
    and missing files.

    • Drupal page request log :: Records all Drupal page loads on your website.

    • Drupal watchdog log :: Records Drupal-related actions on your website. The watchdog
    log is recorded on your server if you have enabled the syslog module.

    • MySQL slow query log :: Contains a list of MySQL queries that have taken longer
    than one second to complete.

    • PHP error log :: Records any issues that occur during the PHP processing portion
    of a page load. Issues reported here are usually caused by a website’s code,
    configuration, or content.

- control_key: AU-02
  control_key_part: b
  control_name: AUDITABLE EVENTS
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    All security-related issues and events, including requests for server log analysis,
    are recorded in CivicActions' JIRA tracking system.

- control_key: AU-02
  control_key_part: c
  control_name: AUDITABLE EVENTS
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    CivicActions has extensive experience and specialization as a host of websites
    that are built using the Drupal web hosting platform. Our list of auditable events
    is also informed by the experience and advice of Drupal's security team, which
    receives security vulnerability reports and publishes security updates related
    to Drupal and the more than 1 million websites that use the Drupal platform. 
    Should the need for additional logging become evident, we have the ability to
    do so by modifying the website's source code to insert additional Drupal watchdog
    hooks.

- control_key: AU-02
  control_key_part: d
  control_name: AUDITABLE EVENTS
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    All CivicActions Drupal sites have access to several different server log types.
    Transactions are captured in several different log types, including the following:

    • Access logs: Captures all requests passed to the web server

    • Drupal request logs: Captures all requests passed to the Drupal application

    • Drupal watchdog: Captures additional details of significant transactions
    processed by Drupal, such as the username of a login attempts

    • PHP error logs: Captures any errors logged during execution of the PHP programming language

    • Node revision history: Captures each revision made to a piece of content on the website
    
    Information captured in the transaction logs includes, but is not limited to, the following
    auditable events:

    • Failed login attempts

    • Successful login attempts

    • User account deletions

    • User account blocking/unblocking

    • Changes in user role assignments

    • Unauthorized attempts to alter protected user fields

    • New user account creation

    • Password reset instructions mailed

    • User logins via one-time login link

    • User logouts

    • Content creation (datasets, resources and other content types)

    • Content modification

    • Content deletion

    • Content publishing

    • Content unpublishing

    • File uploads

    • Web page not found

    • Website configuration changes

    • System administration activities

- control_key: AU-03
  control_key_part: ~
  control_name: CONTENT OF AUDIT RECORDS
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    The logs collected for Drupal sites include the following types of information:

    • IP number of the request originator

    • Timestamp

    • Request URL

    • HTTP status code returned

    • Username

    • Drupal watchdog message (if applicable)

    • Unique numerical ID of the content being modified (for content creation,
    modification and deletion events)

    When auditing a Drupal incident, CivicActions' developers aggregate log sources
    from multiple servers into spreadsheets so that all log entries for a single managed
    security incident can be analyzed in a single document.  Log sources are manually
    sorted, filtered and reviewed.  Application logs are maintained primarily for
    after-the-fact investigation of critical system or security events.

- control_key: AU-04
  control_key_part: ~
  control_name: AUDIT STORAGE CAPACITY
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Inherited (Cloud Service Provider)
  implementation_status: In Place
  narrative: >
    CivicActions ensures adequate storage capability requirements listed in AU-11 for all
    events from the application, database, and hosting environment.

- control_key: AU-05
  control_key_part: b
  control_name: RESPONSE TO AUDIT PROCESSING FAILURES
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    When an auditing processing failure occurs, the Drupal system will overwrite the
    oldest audit records. The Drupal watchdog module is used in both the server and
    a log file created by the AWS and record details of significant transactions
    processed by Drupal.

- control_key: AU-06
  control_key_part: a
  control_name: AUDIT REVIEW, ANALYSIS, AND REPORTING
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: Planned
  narrative: >
    CivicActions security audit data is collected and collated by CivicActions personnel
    weekly or as required to support an after-the-fact investigation at the application
    level for the following:

    • Indications of inappropriate or unusual activity

    • Assurance that logging is functioning properly

    • Adherence to logging standards identified in this procedure

- control_key: AU-06
  control_key_part: b
  control_name: AUDIT REVIEW, ANALYSIS, AND REPORTING
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: Planned
  narrative: >
    Any significant findings observed during the inspection are reported to the CivicActions
    security team.  If these are considered to constitute a security incident, then
    the Incident Response process is invoked as described in the implementation of
    the Incident Response Plan (IR-8).
    
- control_key: AU-09
  control_key_part: ~
  control_name: PROTECTION OF AUDIT INFORMATION
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Inherited (Cloud Service Provider)
  implementation_status: Planned
  narrative: >
    CivicActions ensures that audit logs are created, stored and maintained. Developers
    who have been assigned as members of the CivicActions Security Team are the only
    CivicActions personnel with logical permission to access and download audit logs.

- control_key: AU-11
  control_key_part: ~
  control_name: AUDIT RECORD RETENTION
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Inherited (Cloud Service Provider)
  implementation_status: In Place
  narrative: >
    CivicActions audits events from the application, database, and hosting environment,
    and retains these records for at least 180 days.

- control_key: AU-12
  control_key_part: a
  control_name: AUDIT GENERATION
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    CivicActions ensures audit records are generated for its web and event logs as required
    in AU-2 and AU-3 for servers, application, database and network components.

- control_key: AU-12
  control_key_part: b
  control_name: AUDIT GENERATION
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    The selected auditable events described in AU-2 are coordinated by CivicActions
    internal admins and client security/operations officers for each component of the
    production system.

- control_key: AU-12
  control_key_part: c
  control_name: AUDIT GENERATION
  standard_key: NIST-800-53
  covered_by: []
  security_control_type: Hybrid
  implementation_status: In Place
  narrative: >
    Drupal generates audit records for its web and event logs as described in AU-2 and AU-3.
